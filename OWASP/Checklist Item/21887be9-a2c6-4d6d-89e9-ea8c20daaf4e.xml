<?xml version="1.0" encoding="utf-8"?><guidanceItem id="21887be9-a2c6-4d6d-89e9-ea8c20daaf4e" type="checklist" title="Authentication Cookies are Not Persisted" cssFile="guidance.css" Date="2010-10-03T03:28:12.375Z" Author="" Category="Authentication" filePath="..\Libraries\OWASP\Checklist Item\21887be9-a2c6-4d6d-89e9-ea8c20daaf4e.xml" Priority="2" Rule_Type="Implementation" Source="SI" status="" Status="" Technology="ASP.NET 3.5" Topic="Security" Type="Checklist Item" xmlns="urn:microsoft:guidanceexplorer:guidanceItem"><content><![CDATA[<H1>What to Check For</H1><P>Ensure that&nbsp;authentication cookies are not stored in the user's profile.</P><H1>Why</H1><P>Stored authentication cookies&nbsp;can be stolen if an attacker gets physical access to the user's computer. </P><H1>How to Fix</H1><P>To ensure a non-persistent cookie, set the <B>DisplayRememberMe</B> property of the <B>Login</B> control to <B>false</B>.</P><P>If you are not using the login controls, you can specify a non-persistent cookie when you call either the <B>RedirectFromLoginPage</B> or <B>SetAuthCookie</B> methods of the <B>FormsAuthentication</B> class having validated the user's credentials, as shown here:</P><P><PRE>public void Login_Click(object sender, EventArgs e)</PRE><PRE>&#123;<BR>   // Is the user valid?<BR>   if (Membership.ValidateUser(userName.Text, password.Text))<BR>   &#123;<BR>        // Parameter two set to false indicates non-persistent cookie<BR>        FormsAuthentication.RedirectFromLoginPage(username.Text, false);<BR>    &#125;<BR>    else<BR>    &#123;<BR>        Status.Text = "Invalid credentials. Please try again.";<BR>    &#125;<BR>&#125;</PRE></P><HR><P>Adapted from Microsoft patterns &amp; practices guidance. </P>
]]></content></guidanceItem>