<?xml version="1.0" encoding="utf-8"?><guidanceItem id="cd912611-c89d-44cd-ab4c-831af27b2738" type="checklist" title="Protected resources are mapped to HttpForbiddenHandler." cssFile="guidance.css" Date="2011-01-20T03:20:54.296875Z" Author="" Category="Server Hardening" filePath="..\Libraries\OWASP\Checklist Item\cd912611-c89d-44cd-ab4c-831af27b2738.xml" Priority="J.D. Meier, Alex Mackman, Michael Dunner, Srinath Vasireddy, Ray Escamilla and Anandha Murukan" Rule_Type="Deployment" Source="OWASP" Status="" Technology=" Any" Topic="Security" Type="Checklist Item" xmlns="urn:microsoft:guidanceexplorer:guidanceItem"><content><![CDATA[<H1>Applies to</H1><UL><LI><DIV>Web Application</DIV></LI></UL><H1>What to Check For</H1><P>Check to ensure that Protected resources are mapped to HttpForbiddenHandler.</P><P></P><H1>How to Fix</H1><P>HTTP handlers are located in the Machine.config file beneath the <B>&lt;httpHandlers&gt; </B>element. HTTP handlers are responsible for processing Web requests for specific file&nbsp;extensions. Remoting should not be enabled on front-end Web servers; enable remoting only on middle-tier application servers that are isolated from the Internet.</P><BLOCKQUOTE><B>Note</B>&nbsp;&nbsp;&nbsp;If you are running .NET 2.0, the &lt; httpHandlers&gt; setting is located in the machine-level Web.config file, located in the same directory as the Machine.config file.</BLOCKQUOTE><P>The following file extensions are mapped in the Machine.config file to HTTP<B> </B>handlers: </P><UL><LI>.aspx is used for ASP.NET pages <LI>.rem and .soap are used for Remoting. <LI>.asmx is used for Web Services. <LI>.asax, .ascx, .config, .cs, .csproj, .vb, .vbproj, .webinfo, .asp, .licx, .resx,&nbsp;and&nbsp;.resources are protected resources and are mapped to <B>System.Web.HttpForbiddenHandler</B>. </LI></UL><P>For .NET&nbsp;Framework resources, if you do not use a file extension, then map the extension to <B>System.Web.HttpForbiddenHandler</B> in the Machine.config file, as shown in the following example:</P><DIV><PRE>&lt;add verb="&#42;" path="&#42;.vbproj" type="System.Web.HttpForbiddenHandler" /&gt;</PRE></DIV><P>In this case, the .vbproj file extension is mapped to <B>System.Web.HttpForbiddenHandler</B>. If a client requests a path that ends with .vbproj, then ASP.NET returns a message that states "This type of page is not served." </P><UL><LI>The following guidelines apply to handling .NET&nbsp;Framework file extensions: <LI><B>Map extensions you do not use to HttpForbiddenHandler</B>. If you do not serve ASP.NET pages, then map .aspx to <B>HttpForbiddenHandler</B>. If you do not use Web Services, then map .asmx to <B>HttpForbiddenHandler</B>. <LI><B>Disable Remoting on Internet-facing Web servers</B>. Map remoting extensions (.soap and .rem) on Internet-facing Web servers to <B>HttpForbiddenHandler</B>. </LI></UL><H3>Disable .NET&nbsp;Remoting</H3><P>To disable .NET&nbsp;Remoting disable requests for .rem and .soap extensions, use the following elements beneath<B> &lt;httpHandlers&gt;</B>:</P><DIV><PRE>&lt;add verb="&#42;" path="&#42;.rem" type="System.Web.HttpForbiddenHandler"/&gt;<BR>&lt;add verb="&#42;" path="&#42;.soap" type="System.Web.HttpForbiddenHandler"/&gt;</PRE></DIV><BLOCKQUOTE><B>Note</B>&nbsp;&nbsp;&nbsp;This does not prevent a Web application on the Web server from connecting to a downstream object by using the Remoting infrastructure. However, it prevents clients from connecting to objects on the Web server.</BLOCKQUOTE><HR><P>Adapted from Microsoft patterns &amp; practices guidance.</P>]]></content></guidanceItem>