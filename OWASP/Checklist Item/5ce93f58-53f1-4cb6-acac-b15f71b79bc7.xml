<?xml version="1.0" encoding="utf-8"?><guidanceItem id="5ce93f58-53f1-4cb6-acac-b15f71b79bc7" type="checklist" title="Access to the Credential Store is Limited" cssFile="guidance.css" Date="2010-12-29T22:37:33.4375Z" Author="" Category="Authentication" filePath="..\Libraries\OWASP\Checklist Item\5ce93f58-53f1-4cb6-acac-b15f71b79bc7.xml" Priority="2" Rule_Type="Implementation" Source="SI" Status="" Technology="Java" Topic="Security" Type="Checklist Item" xmlns="urn:microsoft:guidanceexplorer:guidanceItem"><content><![CDATA[<H1>What to Check For</H1><P>Ensure that access to the credential store is limited to administrators with the correct privileges. </P><H1>Why</H1><P>Unauthorized access to the credential store can lead to users' credentials being overwritten; therefore, allowing the attacker to gain access to application resources without obtaining valid credentials prior to the attack.</P><H1>How to Check</H1><P>Follow these steps to ensure that the credential store is properly secured: </P><OL><LI><P><STRONG>Identify all routines that access the store. </STRONG>Locate all routines within your application that access the credential store. Such routines include:</P><UL><LI>Authenticating users <LI>Creating users <LI>Modifying users <LI>Changing user passwords</LI></UL><LI><P><STRONG>Verify that credentials for accessing the store are secured. </STRONG>Ensure that your application's access credentials and connection strings are not hard-coded into your application's code base. </P><UL><LI>If your application <STRONG>uses a database</STRONG> for its credential repository, follow the <A href="ruledisplay:347C1DE9-9132-4B10-9523-64059EAA9F48">Connection Strings are Secured</A> checklist to ensure that access credentials and connection strings are secured properly. <LI>If your application <STRONG>does not use a database</STRONG> for its credential repository, consult the <A href="ruledisplay:FA468EF2-F27F-40B8-BD43-302F66AA9C26">Plaintext Sensitive Data is Not Stored</A> checklist. Verify that only the appropriate components of your application are able to access the credential store.<BR><BR>Example of how <STRONG>not</STRONG> to handle access to the credential store: </LI></UL><P></P><BLOCKQUOTE><BLOCKQUOTE><PRE>// The application discloses the credentials necessary for accessing the user database<BR>DriverManager.registerDriver(new oracle.jdbc.driver.OracleDriver());<BR>Connection cn = DriverManager.getConnection("jdbc:oracle:thin:&#64;testbox:1521:orcl2", "myapp", "pass"); </PRE></BLOCKQUOTE></BLOCKQUOTE><LI><P><STRONG>Check the access controls for your credential store.</STRONG> Ensure that your application's credential store has the appropriate security in place. For instance, if your application uses a database for its credential store, verify that the database server is secured properly.</P></LI></OL><OL></OL><H1>Problem Example</H1><P>The following code authenticates a user based on their credentials. Because the code discloses the credentials to the user database, anybody with access to the code also has&nbsp;access to the credential store. </P><BLOCKQUOTE><PRE>public boolean validateUser(String user, char&#91;&#93; pass)<BR> &#123;<BR>      boolean valid;<BR>      Connection cn;<BR>       // Prepare credentials before querying the credential store<BR>      ...<BR>       try<BR>      &#123;<BR>            // The application discloses the credentials necessary for<BR>            // accessing the user database<BR>            DriverManager.registerDriver(new oracle.jdbc.driver.OracleDriver());<BR>            cn = DriverManager.getConnection("jdbc:oracle:thin:&#64;testbox:1521:orcl2",<BR>                                              "myapp", "pass");<BR>            // Query the credential store and perform the rest<BR>            // of the authentication steps<BR>            ...<BR>      &#125;<BR>      catch (SQLException se)<BR>      &#123;<BR>            // Add the appropriate logging and exception handling mechanisms<BR>            return false;<BR>      &#125;<BR>       return valid;<BR>&#125;</PRE></BLOCKQUOTE><H1>Related Guideline</H1><UL><LI><A href="ruledisplay:AEE6B133-B34C-442F-9051-0D8DC51F072E">Guideline: Limit Access to the Credential Store (Java Web Application)</A> </LI></UL>
]]></content></guidanceItem>