<?xml version="1.0" encoding="utf-8"?><guidanceItem id="9ced6a73-1c18-4f7b-83a0-7094731042f5" type="checklist" title="MSADC virtual directory (RDS) is removed or secured." cssFile="guidance.css" Date="2011-01-20T03:20:10.890625Z" Author="" Category="Server Hardening" filePath="..\Libraries\OWASP\Checklist Item\9ced6a73-1c18-4f7b-83a0-7094731042f5.xml" Priority="J.D. Meier, Alex Mackman, Michael Dunner, Srinath Vasireddy, Ray Escamilla and Anandha Murukan" Rule_Type="Deployment" Source="OWASP" Status="" Technology=" Any" Topic="Security" Type="Checklist Item" xmlns="urn:microsoft:guidanceexplorer:guidanceItem"><content><![CDATA[<H1>Applies to</H1><UL><LI><DIV>Web Application</DIV></LI></UL><H1>What to Check For</H1><P>Check to ensure that the MSADC virtual directory (RDS) is removed or secured.</P><P></P><H1>How to Fix</H1><P>Remote Data Services (RDS) is a component that enables controlled Internet access to&nbsp;remote data resources through IIS. The RDS interface is provided by Msadcs.dll, which is located in the following directory: program files\common files\system\Msadc.</P><H3>Removing RDS</H3><P>If your applications do not use RDS, remove it.</P><P><B>To remove RDS support</B> </P><OL><LI>Remove the /MSADC virtual directory mapping from IIS. <LI>Remove the RDS files and subdirectories at the following location: <P>\Program Files\Common Files\System\Msadc </P><LI>Remove the following registry key: <P>HKLM\System\CurrentControlSet\Services\W3SVC\Parameters\ADCLaunch </P></LI></OL><BLOCKQUOTE><B>Note</B>&nbsp;&nbsp;&nbsp;IISLockdown provides an option to remove the MSADC virtual directory. Note that IISLockdown only removes the virtual directory, not the files or registry key.</BLOCKQUOTE><H3>Securing RDS</H3><P>If your applications require RDS, secure it.</P><P><B>To secure RDS</B> </P><OL><LI>Delete the samples at the following location: <P>\Progam Files\Common Files\System\Msadc\Samples </P><LI>Remove the following registry key: <P><B>HKLM\System\CurrentControlSet\Services\W3SVC\Parameters\ADCLaunch\VbBusObj.VbBusObjCls</B> </P><LI>Disable Anonymous access for the MSADC virtual directory in IIS. <LI>Create a <B>HandlerRequired</B> registry key in the following location: <P><B>HKLM\Software\Microsoft\DataFactory\HandlerInfo\</B> </P><LI>Create a new DWORD value, and set it to <B>1</B> (1 indicates safe mode, while 0 indicates unsafe mode. </LI></OL><BLOCKQUOTE><B>Note</B>&nbsp;&nbsp;&nbsp;You can use the registry script file Handsafe.reg to change the registry key. The script file is located in the msadc directory: \Program Files\Common Files\System\msadc</BLOCKQUOTE><H1>Additional Resources</H1><P>For more information about securing RDS, see the following: </P><UL><LI>MS99-025 Microsoft Security Program: Unauthorized Access to IIS Servers through ODBC Data Access with RDS at <A href="http://www.microsoft.com/technet/security/bulletin/ms99-025.mspx">http://www.microsoft.com/technet/security/bulletin/ms99-025.mspx</A>. <LI>MS98-004 Microsoft Security Program: Microsoft Security Bulletin: Unauthorized ODBC Data Access with RDS and IIS at <A href="http://www.microsoft.com/technet/security/bulletin/ms98-004.mspx">http://www.microsoft.com/technet/security/bulletin/ms98-004.mspx</A>. <LI>Microsoft Knowledge Base article 184375, "PRB: Security Implications of RDS 1.5, IIS 3.0 or 4.0, and ODBC." </LI></UL><HR><P>Adapted from Microsoft patterns &amp; practices guidance.</P>]]></content></guidanceItem>