<?xml version="1.0" encoding="utf-8"?><guidanceItem id="5d671ebe-781c-4de8-b1ef-f8e69fd13f73" type="guideline" title="Restrict All Role Caching Cookies to HTTPS Connections" cssFile="guidance.css" Date="2010-09-23T14:39:20.8005966Z" Author=" " Category="Authorization" filePath="..\Libraries\OWASP\Guideline\5d671ebe-781c-4de8-b1ef-f8e69fd13f73.xml" Priority="2" Rule_Type="Implementation" Source="SI" Status="" Technology="ASP.NET 3.5" Topic="Security" Type="Guideline" xmlns="urn:microsoft:guidanceexplorer:guidanceItem"><content><![CDATA[<H1>What to Do</H1><P>Use the <B>cookieRequireSSL</B> attribute to restrict role caching cookies to HTTPS connections if role caching is being used. </P><H1>Why</H1><P>Sending cookies out exclusively over SSL makes it much harder for an attacker to sniff the cookie values off the wire.&nbsp; If an attacker can get a copy of an authorization cookie, they can potentially emulate that role, allowing them to elevate their privilege in the system. </P><H1>When</H1><P>All systems which use authorization cookies should use SSL for those cookies if at all possible.&nbsp; Systems which deal with any personally identifiable information or monetary transaction should use SSL in all circumstances without exception. </P><H1>How</H1><P>Set the <B>cookieRequireSSL</B> attribute to true to specify that the authorization cookie with the role information should only be returned to the server over HTTPS connections.&nbsp; The following example shows a <B>&lt;roleManager&gt;</B> element configured to protect the authorization cookie. </P><PRE>&lt;roleManager enabled="true"             <BR>&#9;cacheRolesInCookie="true"             <BR>&#9;cookieName=".ASPROLES"             <BR>&#9;cookieTimeout="30"             <BR>&#9;cookiePath="/"             <BR>&#9;cookieRequireSSL="true"             <BR>&#9;cookieSlidingExpiration="true"             <BR>&#9;cookieProtection="All"              <BR>&#9;createPersistentCookie="false"&gt;<BR>&lt;/roleManager&gt;</PRE><H1>Related Items</H1><UL><LI><A href="ruledisplay:24e081c4-0c62-4c93-a91a-42a96892d74d">Use Role Caching if Role Store Lookups are too Costly</A></LI></UL><HR><P>Adapted from Microsoft patterns &amp; practices guidance. </P>
]]></content></guidanceItem>