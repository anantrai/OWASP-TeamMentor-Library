<?xml version="1.0" encoding="utf-8"?><guidanceItem id="22701ae6-1207-4e89-b62c-537bd112fb84" type="guideline" title="Disable Directory Browsing" cssFile="guidance.css" Date="2010-12-29T23:09:31.5Z" Author="" Category="Deployment Considerations" filePath="..\Libraries\OWASP\Guideline\22701ae6-1207-4e89-b62c-537bd112fb84.xml" Priority="2" Rule_Type="Deployment" Source="SI" Status="" Technology="Java" Topic="Security" Type="Guideline" xmlns="urn:microsoft:guidanceexplorer:guidanceItem"><content><![CDATA[<H1>Applies to</H1><P>Applications written using Servlets or JSP.</P><H1>What to Do</H1><P>Disable directory browsing for your application's web directories.</P><H1>Why</H1><P>Directory browsing allows an attacker to browse your application's directory structure in search of unprotected files and components.</P><H1>When</H1><P>Disable directory browsing at all times.</P><H1>How</H1><P>Use the following steps to successfully disable directory browsing:</P><OL><LI><P><STRONG>Identify if directory browsing is enabled. </STRONG>Navigate to your application's directories. Identify&nbsp;whether your application's server correctly returns an HTTP error message. If it incorrectly returns&nbsp;the directory contents, continue with the following steps.</P><LI><P><STRONG>Locate the default servlet's configuration. </STRONG>Open your application's deployment descriptor (e.g. web.xml), and locate the default servlet's configuration. If the default servlet is present, it is mapped to the root directory of your application. Example: </P><BLOCKQUOTE><PRE>&lt;servlet&gt;<BR>      &lt;servlet-name&gt;default_servlet&lt;/servlet-name&gt;<BR>      &lt;servlet-class&gt;<BR>            org.apache.catalina.servlets.DefaultServlet<BR>      &lt;/servlet-class&gt;<BR>&lt;/servlet&gt;<BR>&lt;servlet-mapping&gt;<BR>      &lt;servlet-name&gt;default_servlet&lt;/servlet-name&gt;<BR>      &lt;url-pattern&gt;/&lt;/url-pattern&gt;<BR>&lt;/servlet-mapping&gt;</PRE></BLOCKQUOTE><LI><P><STRONG>Deny directory browsing in the default servlet's configuration. </STRONG>Initialize the default servlet with the parameter <STRONG>listings</STRONG> set to <STRONG>false</STRONG>. Example:</P><BLOCKQUOTE><PRE>&lt;servlet&gt;<BR>      &lt;servlet-name&gt;default_servlet&lt;/servlet-name&gt;<BR>      &lt;servlet-class&gt;<BR>            org.apache.catalina.servlets.DefaultServlet<BR>      &lt;/servlet-class&gt;<BR>      <STRONG>&lt;init-param&gt;<BR></STRONG>            &lt;param-name&gt;listings&lt;/param-name&gt;<BR>            &lt;param-value&gt;false&lt;/param-value&gt;<BR><STRONG>      &lt;/init-param&gt;<BR></STRONG>&lt;/servlet&gt;<BR>&lt;servlet-mapping&gt;<BR>      &lt;servlet-name&gt;default_servlet&lt;/servlet-name&gt;<BR>      &lt;url-pattern&gt;/&lt;/url-pattern&gt;<BR>&lt;/servlet-mapping&gt;</PRE></BLOCKQUOTE></LI></OL><H1>Problem Example</H1><P>An application is deployed on a production server. Unfortunately, the developers did not disable directory browsing. This allows an attacker to search for unprotected configuration files.</P><H1>Solution Example</H1><P>An application is deployed on a production server. Because the developers have disabled directory browsing, it is impossible for an attacker to use HTTP browsing to search for unprotected configuration files.</P><H1>Related Items</H1><UL><LI><A href="ruledisplay:E99B2092-A623-447A-8461-1FD8F860AA15">Guideline: Remove Test Interfaces (Java Web Application)</A> <LI><A href="ruledisplay:4572037A-2166-4AD1-8E73-D623E468A7B9">Attack: Information Disclosure Attack</A> <LI><A href="ruledisplay:1D7F6072-1A5F-472E-9D27-F15E396EAB2E">Attack: Forceful Browsing Attack</A> <LI><A href="ruledisplay:1398DA02-651D-4798-95C3-7C3F8409004B">Checklist Item: Directory Browsing is Disabled (Java Web Application)</A> </LI></UL>
]]></content></guidanceItem>