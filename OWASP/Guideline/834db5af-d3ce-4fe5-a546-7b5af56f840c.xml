<?xml version="1.0" encoding="utf-8"?><guidanceItem id="834db5af-d3ce-4fe5-a546-7b5af56f840c" type="guideline" title="Use IPSsec to Encrypt Traffic Between Servers" cssFile="guidance.css" Date="2010-10-03T05:47:39.09375Z" Author="" Category="Communication Security" filePath="..\Libraries\OWASP\Guideline\834db5af-d3ce-4fe5-a546-7b5af56f840c.xml" Priority="2" Rule_Type="Implementation" Source="SI" Status="" Technology="ASP.NET 3.5" Topic="Security" Type="Guideline" xmlns="urn:microsoft:guidanceexplorer:guidanceItem"><content><![CDATA[<H1>What to Do</H1><P>Internet Protocol security (IPSec)&nbsp;provides encryption, integrity, and authentication services for IP-based network traffic.&nbsp;Use&nbsp;IPSec to provide server-to-server protection&nbsp;against internal network threats, including eavesdropping, tampering, man in the middle attacks, IP spoofing, and other password-based attacks by restricting which computers can communicate with each other, and limit the protocols they can communicate with.</P><H1>Why</H1><P>Servers&nbsp;do not usually co-exist in a secure environment. Eavesdropping and spoofing are threats when two or more entities must communicate over&nbsp;typical untrusted mediums such as the public internet&nbsp;or a company intranet. Failure to use IPSec&nbsp;increases the likleihood&nbsp;that data traveling on the network will be intercepted, modified, or&nbsp;stolen.</P><H1>When</H1><P>IPSec can be used&nbsp;for the following tasks:</P><UL><LI>Provide message confidentiality by encrypting all of the data sent between two computers. <LI>Provide message integrity between two computers (without encrypting data). <LI>Provide mutual authentication between two computers. For example, you can help secure a database server by establishing a policy that permits requests only from a specific client computer (for example, an application or Web server). <LI>Restrict which computers can communicate with one another. You can also restrict communication to specific IP protocols and TCP/UDP ports.</LI></UL><P>&nbsp;Using IPSec is not a a possibility when the two servers are not using static ip addresses.</P><H1>How</H1><P>To secure traffic between two servers, follow these steps:</P><OL><LI><P><STRONG>Create an IP Filter.</STRONG> This&nbsp;restricts&nbsp;what computers can communicate with each other, and require that&nbsp;specific&nbsp;communication protocols are used.&nbsp;A filter consists of:</P><UL><LI>A source IP address or range of addresses. <LI>A destination IP address or range of addresses. <LI>An IP protocol, such as TCP, UDP, or "any." <LI>Source and destination ports (for TCP or UDP only).</LI></UL><LI><P><STRONG>Create Filter Actions.</STRONG> This procedure creates two filter actions. The first will be used to block all communications from specified computers and the second will be used to enforce the use of encryption between application server and database server computers. </P><LI><P><STRONG>Create Rules.</STRONG> This procedure creates two new rules that will be used to associate the filter that you created in Procedure 1, with the two filter actions you created in Procedure 2. </P><LI><P><STRONG>Export the IPSec Policy to the Remote Computer.</STRONG> The IPSec policy that you have created on the database server must now be exported and copied to the application server computer. </P><LI><P><STRONG>Assign Policies.</STRONG> An IPSec policy must be assigned before it becomes active. Note that only one policy may be active at any one time on a particular computer. </P><LI><P><STRONG>Verify that it Works.</STRONG> Use Network Monitor (netmon.exe) to verify that data sent between the two servers&nbsp;is encrypted. </P></LI></OL><H1>Additional Resources</H1><UL><LI>How To: Use IPSec to Provide Secure Communication Between Two Servers&nbsp;<A href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnnetsec/html/SecNetHT18.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnnetsec/html/SecNetHT18.asp</A> <LI>How To: Use IPSec for Filtering Ports and Authentication <A href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnnetsec/html/HTUseIPSec.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnnetsec/html/HTUseIPSec.asp</A> <LI>How To: Use IPSec Policy to Secure Terminal Services Communications in Windows Server 2003 <A href="http://support.microsoft.com/kb/816521">http://support.microsoft.com/kb/816521</A> </LI></UL><H1>Related Items</H1><UL><LI><A href="ruledisplay:ecfc4c67-2a6c-443e-844e-8a3051fe54f3">Use IPSsec to Encrypt Traffic Between Servers</A> <LI><A href="ruledisplay:4d8acde8-c44d-46f2-84f1-0c9a8fd1710a">Appropriate Mechanism of Secure Communication (IPSec or SSL) is used, Depending on Application Requirement</A> <LI><A href="ruledisplay:0c3fe1a1-c49c-4187-872e-246e07c875f9">For Communication Between Web Browser and Web Server, SSL is used When Pages Need to be Encrypted</A></LI></UL><HR><P>Adapted from Microsoft patterns &amp; practices guidance. </P>
]]></content></guidanceItem>